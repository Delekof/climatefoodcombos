<!DOCTYPE html>
<html>
<head>
  <title>Climate Food Combos</title>
  <script src="https://cdn.jsdelivr.net/gh/Delekof/climatefoodcombos/data.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<h1>Climate Food Combos</h1>

<div class="slidecontainer">
  <p>Protein supply:</p>
  <input type="range" min="50" max="200" value="120" class="slider" id="proteinRange">
  <input type="number" min="50" max="200" value="120" id="proteinInput">
</div>

<div class="slidecontainer">
  <p>Calorie supply:</p>
  <input type="range" min="2000" max="3500" value="3000" class="slider" id="calorieRange">
  <input type="number" min="2000" max="3500" value="3000" id="calorieInput">
</div>

<div class="slidecontainer">
  <p>"Empty" calories:</p>
  <input type="range" min="0" max="2000" value="1200" class="slider" id="emptycalorieRange">
  <input type="number" min="0" max="2000" value="1200" id="emptycalorieInput">
</div>

<div>
  <p>Calories supply from protein: <span id="proteinpercalorieSupply"></span></p>
</div>

<button type="button" onclick="displayProteinFoods()">
  Click me to display protein foods* (*animals are friends not food).
</button>

<p id="demo1"></p>

<button type="button" onclick="displayCarbFoods()">
  Click me to display carbohydrate foods.
</button>

<p id="demo2"></p>

<script>
  function calculateProteinPerKcal(data) {
    for (let food in data) {
      let protein = data[food].protein;
      let kcal = data[food].kcal;
      data[food].protein_per_kcal = parseFloat((protein / kcal).toFixed(2));
    }
  }

  function displayProteinFoods() {
    document.getElementById('demo1').innerHTML = JSON.stringify(proteinFoods, null, 2);
  }

  function displayCarbFoods() {
    document.getElementById('demo2').innerHTML = JSON.stringify(carbFoods, null, 2);
  }

  var proteinRange = document.getElementById("proteinRange");
  var proteinInput = document.getElementById("proteinInput");

  var calorieRange = document.getElementById("calorieRange");
  var calorieInput = document.getElementById("calorieInput");

  var emptycalorieRange = document.getElementById("emptycalorieRange");
  var emptycalorieInput = document.getElementById("emptycalorieInput");

  var proteinPerCalorieSupply = document.getElementById("proteinpercalorieSupply");

  proteinPerCalorieSupply.innerHTML = String((100 * 4 * proteinRange.value / (calorieRange.value - emptycalorieRange.value)).toFixed(2)) + "%";

  function updateProteinSupply() {
    proteinInput.value = proteinRange.value;
    updateProteinPerCalorieSupply();
  }

  function updateCalorieSupply() {
    calorieInput.value = calorieRange.value;
    updateProteinPerCalorieSupply();
  }

  function updateEmptyCalorieSupply() {
    emptycalorieInput.value = emptycalorieRange.value;
    updateProteinPerCalorieSupply();
  }

  function updateProteinPerCalorieSupply() {
    proteinPerCalorieSupply.innerHTML = String((100 * 4 * proteinRange.value / (calorieRange.value - emptycalorieRange.value)).toFixed(2)) + "%";
  }

  proteinRange.oninput = updateProteinSupply;
  calorieRange.oninput = updateCalorieSupply;
  emptycalorieRange.oninput = updateEmptyCalorieSupply;

  proteinInput.oninput = function() {
    proteinRange.value = this.value;
    updateProteinSupply();
  }

  calorieInput.oninput = function() {
    calorieRange.value = this.value;
    updateCalorieSupply();
  }

  emptycalorieInput.oninput = function() {
    emptycalorieRange.value = this.value;
    updateEmptyCalorieSupply();
  }

  // Ensure external data is processed correctly
  calculateProteinPerKcal(nutritional_data);

</script>

</body>
</html>
